{% comment %}
  Animated Hero Slider Section with Image Upload
  Fully customizable in Shopify theme editor
{% endcomment %}

<style>
  .animated-hero-{{ section.id }} {
    background: {{ section.settings.bg_color }};
    min-height: {{ section.settings.section_height }}px;
    position: relative;
    overflow: hidden;
    display: flex;
    align-items: center;
    padding: 60px 20px;
  }

  .animated-hero-{{ section.id }} .container {
    max-width: 1400px;
    margin: 0 auto;
    width: 100%;
    position: relative;
    z-index: 2;
  }

  .animated-hero-{{ section.id }} .slider-wrapper {
    position: relative;
  }

  .animated-hero-{{ section.id }} .slide {
    display: none;
    grid-template-columns: 1fr 1fr;
    gap: 80px;
    align-items: center;
    animation: fadeSlideIn 0.8s ease-out;
  }

  .animated-hero-{{ section.id }} .slide.active {
    display: grid;
  }

  .animated-hero-{{ section.id }} .content-side {
    order: 1;
  }

  .animated-hero-{{ section.id }} .hero-title {
    font-size: {{ section.settings.title_size }}px;
    font-weight: {{ section.settings.title_weight }};
    color: {{ section.settings.title_color }};
    line-height: 1.2;
    margin-bottom: 20px;
    letter-spacing: -0.5px;
  }

  .animated-hero-{{ section.id }} .hero-description {
    font-size: {{ section.settings.desc_size }}px;
    color: {{ section.settings.desc_color }};
    line-height: 1.6;
    margin-bottom: 40px;
    opacity: 0.9;
  }

  .animated-hero-{{ section.id }} .hero-button {
    display: inline-block;
    padding: {{ section.settings.btn_padding_y }}px {{ section.settings.btn_padding_x }}px;
    background: {{ section.settings.btn_bg }};
    color: {{ section.settings.btn_color }};
    text-decoration: none;
    border-radius: {{ section.settings.btn_radius }}px;
    font-weight: 600;
    font-size: {{ section.settings.btn_size }}px;
    transition: all 0.3s ease;
    border: 2px solid transparent;
  }

  .animated-hero-{{ section.id }} .hero-button:hover {
    background: {{ section.settings.btn_bg_hover }};
    transform: translateY(-2px);
    box-shadow: 0 10px 30px rgba(255,255,255,0.1);
    color:black;
  }

  .animated-hero-{{ section.id }} .visual-side {
    position: relative;
    height: 500px;
    display: flex;
    align-items: center;
    justify-content: center;
    order: 2;
  }

  .animated-hero-{{ section.id }} .image-container {
    width: 100%;
    height: 100%;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .animated-hero-{{ section.id }} .slide-image {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    border-radius: {{ section.settings.image_radius }}px;
    animation: float 6s ease-in-out infinite;
    filter: drop-shadow(0 20px 40px rgba(0,0,0,0.3));
  }

  .animated-hero-{{ section.id }} .geometric-overlay {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    pointer-events: none;
    z-index: 1;
  }

  .animated-hero-{{ section.id }} .shape-container {
    width: 100%;
    height: 100%;
    position: relative;
    transform-style: preserve-3d;
    animation: rotate3d 20s linear infinite;
  }

  .animated-hero-{{ section.id }} .wireframe-lines {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
  }

  .animated-hero-{{ section.id }} .line {
    position: absolute;
    background: {{ section.settings.shape_color }};
    transform-origin: center;
    opacity: 0;
    animation: lineAppear 2s ease-out forwards;
  }

  .animated-hero-{{ section.id }} .inner-glow {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 400px;
    height: 400px;
    transform: translate(-50%, -50%);
    border-radius: 50%;
    background: radial-gradient(circle, rgba(255,255,255,0.05) 0%, transparent 70%);
    animation: pulse 4s ease-in-out infinite;
  }

  .animated-hero-{{ section.id }} .particle {
    position: absolute;
    width: 2px;
    height: 2px;
    background: {{ section.settings.particle_color }};
    border-radius: 50%;
    animation: particleFloat 3s ease-in-out infinite;
  }

  /* Slider Controls */
  .animated-hero-{{ section.id }} .slider-controls {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 30px;
    margin-top: 40px;
  }

  .animated-hero-{{ section.id }} .slider-btn {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: {{ section.settings.control_bg }};
    border: 2px solid {{ section.settings.control_border }};
    color: {{ section.settings.control_color }};
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    font-size: 20px;
  }

  .animated-hero-{{ section.id }} .slider-btn:hover {
    background: {{ section.settings.control_bg_hover }};
    transform: scale(1.1);
  }

  .animated-hero-{{ section.id }} .slider-dots {
    display: flex;
    gap: 12px;
  }

  .animated-hero-{{ section.id }} .dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: {{ section.settings.dot_color }};
    opacity: 0.3;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .animated-hero-{{ section.id }} .dot.active {
    opacity: 1;
    width: 40px;
    border-radius: 6px;
    background: {{ section.settings.dot_active_color }};
  }

  /* Animations */
  @keyframes fadeSlideIn {
    from {
      opacity: 0;
      transform: translateX(-30px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-20px); }
  }

  @keyframes rotate3d {
    from { transform: rotateY(0deg) rotateX(15deg); }
    to { transform: rotateY(360deg) rotateX(15deg); }
  }

  @keyframes lineAppear {
    from {
      opacity: 0;
      transform: scaleX(0);
    }
    to {
      opacity: {{ section.settings.shape_opacity }};
      transform: scaleX(1);
    }
  }

  @keyframes pulse {
    0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 0.3; }
    50% { transform: translate(-50%, -50%) scale(1.2); opacity: 0.5; }
  }

  @keyframes particleFloat {
    0%, 100% { transform: translate(0, 0); opacity: 0; }
    50% { opacity: 1; }
  }

  /* Responsive */
  @media (max-width: 1024px) {
    .animated-hero-{{ section.id }} .slide {
      grid-template-columns: 1fr;
      gap: 40px;
      text-align: center;
    }

    .animated-hero-{{ section.id }} .visual-side {
      height: 400px;
      order: 1;
    }

    .animated-hero-{{ section.id }} .content-side {
      order: 2;
    }

    .animated-hero-{{ section.id }} .hero-title {
      font-size: {{ section.settings.title_size | times: 0.8 }}px;
    }
  }

  @media (max-width: 768px) {
    .animated-hero-{{ section.id }} {
      min-height: auto;
      padding: 40px 20px;
    }

    .animated-hero-{{ section.id }} .visual-side {
      height: 300px;
    }

    .animated-hero-{{ section.id }} .hero-title {
      font-size: {{ section.settings.title_size | times: 0.6 }}px;
    }

    .animated-hero-{{ section.id }} .hero-description {
      font-size: {{ section.settings.desc_size | times: 0.9 }}px;
    }

    .animated-hero-{{ section.id }} .slider-btn {
      width: 40px;
      height: 40px;
      font-size: 16px;
    }

    .animated-hero-{{ section.id }} .slider-controls {
      gap: 20px;
      margin-top: 30px;
    }
  }
</style>

<section class="animated-hero-{{ section.id }}">
  <div class="container">
    <div class="slider-wrapper">
      {% for block in section.blocks %}
        <div class="slide {% if forloop.first %}active{% endif %}" data-slide="{{ forloop.index0 }}">
          <div class="content-side">
            {% if block.settings.title != blank %}
              <h1 class="hero-title">{{ block.settings.title }}</h1>
            {% endif %}
            
            {% if block.settings.description != blank %}
              <p class="hero-description">{{ block.settings.description }}</p>
            {% endif %}
            
            {% if block.settings.button_text != blank and block.settings.button_link != blank %}
              <a href="{{ block.settings.button_link }}" class="hero-button">
                {{ block.settings.button_text }}
              </a>
            {% endif %}
          </div>

          <div class="visual-side">
            <div class="image-container">
              {% if block.settings.image != blank %}
                <img src="{{ block.settings.image | img_url: '800x' }}" 
                     alt="{{ block.settings.title | escape }}"
                     class="slide-image"
                     loading="lazy">
              {% else %}
                <div style="width: 100%; height: 100%; background: rgba(255,255,255,0.1); border-radius: {{ section.settings.image_radius }}px; display: flex; align-items: center; justify-content: center; color: rgba(255,255,255,0.3); font-size: 18px;">
                  Upload Image
                </div>
              {% endif %}
              
              {% if section.settings.show_geometric_overlay %}
              <div class="geometric-overlay">
                <div class="shape-container">
                  <div class="wireframe-lines" id="wireframe-{{ section.id }}-{{ forloop.index0 }}"></div>
                  <div class="inner-glow"></div>
                </div>
              </div>
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}

      {% if section.blocks.size > 1 %}
      <div class="slider-controls">
        {% comment %} <button class="slider-btn prev-btn" aria-label="Previous slide">‹</button> {% endcomment %}
        <div class="slider-dots">
          {% for block in section.blocks %}
            <span class="dot {% if forloop.first %}active{% endif %}" data-slide="{{ forloop.index0 }}"></span>
          {% endfor %}
        </div>
        {% comment %} <button class="slider-btn next-btn" aria-label="Next slide">›</button> {% endcomment %}
      </div>
      {% endif %}
    </div>
  </div>
</section>

<script>
  (function() {
    const sectionId = '{{ section.id }}';
    const slides = document.querySelectorAll(`.animated-hero-${sectionId} .slide`);
    const dots = document.querySelectorAll(`.animated-hero-${sectionId} .dot`);
    const prevBtn = document.querySelector(`.animated-hero-${sectionId} .prev-btn`);
    const nextBtn = document.querySelector(`.animated-hero-${sectionId} .next-btn`);
    let currentSlide = 0;
    let autoplayInterval;

    // Initialize geometric shapes
    function initGeometricShapes() {
      const wireframes = document.querySelectorAll(`.animated-hero-${sectionId} .wireframe-lines`);
      
      wireframes.forEach((wireframe) => {
        if (wireframe.children.length > 0) return; // Already initialized
        
        const width = 400;
        const height = 400;
        const centerX = width / 2;
        const centerY = height / 2;
        
        // Icosahedron vertices
        const phi = (1 + Math.sqrt(5)) / 2;
        const vertices = [
          [0, 1, phi], [0, -1, phi], [0, 1, -phi], [0, -1, -phi],
          [1, phi, 0], [-1, phi, 0], [1, -phi, 0], [-1, -phi, 0],
          [phi, 0, 1], [-phi, 0, 1], [phi, 0, -1], [-phi, 0, -1]
        ].map(v => {
          const len = Math.sqrt(v[0]*v[0] + v[1]*v[1] + v[2]*v[2]);
          return v.map(c => c / len * 100);
        });

        // Icosahedron edges
        const edges = [
          [0,1],[0,4],[0,5],[0,8],[0,9],[1,6],[1,7],[1,8],[1,9],
          [2,3],[2,4],[2,5],[2,10],[2,11],[3,6],[3,7],[3,10],[3,11],
          [4,5],[4,8],[4,10],[5,9],[5,11],[6,7],[6,8],[6,10],
          [7,9],[7,11],[8,10],[9,11]
        ];

        // Draw edges
        edges.forEach((edge, i) => {
          const [x1, y1] = [vertices[edge[0]][0] + centerX, vertices[edge[0]][1] + centerY];
          const [x2, y2] = [vertices[edge[1]][0] + centerX, vertices[edge[1]][1] + centerY];
          
          const length = Math.sqrt((x2-x1)**2 + (y2-y1)**2);
          const angle = Math.atan2(y2-y1, x2-x1) * 180 / Math.PI;
          
          const line = document.createElement('div');
          line.className = 'line';
          line.style.width = length + 'px';
          line.style.height = '1px';
          line.style.left = x1 + 'px';
          line.style.top = y1 + 'px';
          line.style.transform = `rotate(${angle}deg)`;
          line.style.animationDelay = (i * 0.03) + 's';
          wireframe.appendChild(line);
        });

        // Create particles
        const particleCount = 20;
        const innerGlow = wireframe.parentElement.querySelector('.inner-glow');
        
        for (let i = 0; i < particleCount; i++) {
          const particle = document.createElement('div');
          particle.className = 'particle';
          
          const angle = Math.random() * Math.PI * 2;
          const radius = 50 + Math.random() * 150;
          const x = Math.cos(angle) * radius + 200;
          const y = Math.sin(angle) * radius + 200;
          
          particle.style.left = x + 'px';
          particle.style.top = y + 'px';
          particle.style.animationDelay = (Math.random() * 3) + 's';
          particle.style.animationDuration = (2 + Math.random() * 2) + 's';
          
          innerGlow.appendChild(particle);
        }
      });
    }

    function showSlide(index) {
      slides.forEach((slide, i) => {
        slide.classList.remove('active');
        if (i === index) {
          slide.classList.add('active');
        }
      });

      dots.forEach((dot, i) => {
        dot.classList.remove('active');
        if (i === index) {
          dot.classList.add('active');
        }
      });

      currentSlide = index;
    }

    function nextSlide() {
      const next = (currentSlide + 1) % slides.length;
      showSlide(next);
    }

    function prevSlide() {
      const prev = (currentSlide - 1 + slides.length) % slides.length;
      showSlide(prev);
    }

    function startAutoplay() {
      {% if section.settings.autoplay %}
      autoplayInterval = setInterval(nextSlide, {{ section.settings.autoplay_speed }} * 1000);
      {% endif %}
    }

    function stopAutoplay() {
      clearInterval(autoplayInterval);
    }

    // Event listeners
    if (nextBtn) {
      nextBtn.addEventListener('click', () => {
        nextSlide();
        stopAutoplay();
        startAutoplay();
      });
    }

    if (prevBtn) {
      prevBtn.addEventListener('click', () => {
        prevSlide();
        stopAutoplay();
        startAutoplay();
      });
    }

    dots.forEach(dot => {
      dot.addEventListener('click', (e) => {
        const slideIndex = parseInt(e.target.dataset.slide);
        showSlide(slideIndex);
        stopAutoplay();
        startAutoplay();
      });
    });

    // Initialize
    initGeometricShapes();
    startAutoplay();

    // Pause on hover
    const sliderWrapper = document.querySelector(`.animated-hero-${sectionId} .slider-wrapper`);
    sliderWrapper.addEventListener('mouseenter', stopAutoplay);
    sliderWrapper.addEventListener('mouseleave', startAutoplay);
  })();
</script>

{% schema %}
{
  "name": "Animated Hero Slider",
  "settings": [
    {
      "type": "header",
      "content": "Section Settings"
    },
    {
      "type": "color",
      "id": "bg_color",
      "label": "Background Color",
      "default": "#0a0a0a"
    },
    {
      "type": "range",
      "id": "section_height",
      "min": 400,
      "max": 900,
      "step": 50,
      "unit": "px",
      "label": "Section Height",
      "default": 600
    },
    {
      "type": "header",
      "content": "Text Styles"
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Title Color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "title_size",
      "min": 24,
      "max": 72,
      "step": 2,
      "unit": "px",
      "label": "Title Size",
      "default": 56
    },
    {
      "type": "range",
      "id": "title_weight",
      "min": 300,
      "max": 900,
      "step": 100,
      "label": "Title Weight",
      "default": 700
    },
    {
      "type": "color",
      "id": "desc_color",
      "label": "Description Color",
      "default": "#cccccc"
    },
    {
      "type": "range",
      "id": "desc_size",
      "min": 14,
      "max": 24,
      "step": 1,
      "unit": "px",
      "label": "Description Size",
      "default": 18
    },
    {
      "type": "header",
      "content": "Button Styles"
    },
    {
      "type": "color",
      "id": "btn_bg",
      "label": "Button Background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "btn_bg_hover",
      "label": "Button Hover Background",
      "default": "#f0f0f0"
    },
    {
      "type": "color",
      "id": "btn_color",
      "label": "Button Text Color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "btn_size",
      "min": 12,
      "max": 20,
      "step": 1,
      "unit": "px",
      "label": "Button Font Size",
      "default": 16
    },
    {
      "type": "range",
      "id": "btn_padding_x",
      "min": 20,
      "max": 60,
      "step": 5,
      "unit": "px",
      "label": "Button Horizontal Padding",
      "default": 40
    },
    {
      "type": "range",
      "id": "btn_padding_y",
      "min": 10,
      "max": 30,
      "step": 2,
      "unit": "px",
      "label": "Button Vertical Padding",
      "default": 16
    },
    {
      "type": "range",
      "id": "btn_radius",
      "min": 0,
      "max": 50,
      "step": 2,
      "unit": "px",
      "label": "Button Border Radius",
      "default": 8
    },
    {
      "type": "header",
      "content": "Image Settings"
    },
    {
      "type": "range",
      "id": "image_radius",
      "min": 0,
      "max": 50,
      "step": 2,
      "unit": "px",
      "label": "Image Border Radius",
      "default": 20
    },
    {
      "type": "header",
      "content": "Geometric Overlay"
    },
    {
      "type": "checkbox",
      "id": "show_geometric_overlay",
      "label": "Show Geometric Overlay",
      "default": true
    },
    {
      "type": "color",
      "id": "shape_color",
      "label": "Wireframe Color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "shape_opacity",
      "min": 0.1,
      "max": 1,
      "step": 0.1,
      "label": "Wireframe Opacity",
      "default": 0.3
    },
    {
      "type": "color",
      "id": "particle_color",
      "label": "Particle Color",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Slider Controls"
    },
    {
      "type": "checkbox",
      "id": "autoplay",
      "label": "Enable Autoplay",
      "default": true
    },
    {
      "type": "range",
      "id": "autoplay_speed",
      "min": 3,
      "max": 10,
      "step": 1,
      "unit": "s",
      "label": "Autoplay Speed",
      "default": 5
    },
    {
      "type": "color",
      "id": "control_bg",
      "label": "Control Button Background",
      "default": "rgba(255,255,255,0.1)"
    },
    {
      "type": "color",
      "id": "control_bg_hover",
      "label": "Control Button Hover",
      "default": "rgba(255,255,255,0.2)"
    },
    {
      "type": "color",
      "id": "control_border",
      "label": "Control Button Border",
      "default": "rgba(255,255,255,0.3)"
    },
    {
      "type": "color",
      "id": "control_color",
      "label": "Control Button Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "dot_color",
      "label": "Dot Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "dot_active_color",
      "label": "Active Dot Color",
      "default": "#ffffff"
    }
  ],
  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Slide Image"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "An attractive and interesting title that describes the companys offer"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Description",
          "default": "Lorem ipsum dolor sit amet consectetur. Urna risus a tempus velit sed turpis tellus."
        },
        {
          "type": "text",
          "id": "button_text",
          "label": "Button Text",
          "default": "Explore Products"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "Button Link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Animated Hero Slider",
      "blocks": [
        {
          "type": "slide"
        },
        {
          "type": "slide"
        },
        {
          "type": "slide"
        }
      ]
    }
  ]
}
{% endschema %}