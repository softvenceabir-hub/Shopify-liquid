{% schema %}
{
  "name": "Split Section Image Text",
  "tag": "section",
  "class": "section-split-image-text",
  "settings": [
    {
      "type": "header",
      "content": "Section Layout"
    },
    {
      "type": "select",
      "id": "layout_direction",
      "label": "Layout: Image Position",
      "default": "right",
      "options": [
        {
          "value": "left",
          "label": "Image on Left / Text on Right"
        },
        {
          "value": "right",
          "label": "Image on Right / Text on Left"
        }
      ],
      "info": "Choose the arrangement for the desktop view."
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#f9f9f9"
    },
    {
      "type": "header",
      "content": "Image Content"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Image",
      "info": "Upload the image for this section."
    },
    {
      "type": "range",
      "id": "image_width",
      "min": 50,
      "max": 150,
      "step": 5,
      "unit": "%",
      "label": "Image Width (Desktop)",
      "default": 100,
      "info": "Adjust the width of the image relative to its container"
    },
    {
      "type": "select",
      "id": "image_position_horizontal",
      "label": "Image Horizontal Position",
      "default": "center",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ]
    },
    {
      "type": "select",
      "id": "image_position_vertical",
      "label": "Image Vertical Position",
      "default": "center",
      "options": [
        {
          "value": "top",
          "label": "Top"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "bottom",
          "label": "Bottom"
        }
      ]
    },
    {
      "type": "select",
      "id": "image_fit",
      "label": "Image Fit",
      "default": "cover",
      "options": [
        {
          "value": "cover",
          "label": "Cover (fills area, may crop)"
        },
        {
          "value": "contain",
          "label": "Contain (fits within area)"
        },
        {
          "value": "fill",
          "label": "Fill (stretches to fit)"
        }
      ],
      "info": "How the image should fit within its container"
    },
    {
      "type": "header",
      "content": "Text Content"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Proudly Canadian â€“ Because Your Sleep Deserves the Best"
    },
    {
      "type": "richtext",
      "id": "subheading",
      "label": "Body Text",
      "default": "<p>At Polysleep, we take pride in offering our customers mattresses entirely made in Canada. Producing locally enables us to work closely with our manufacturer and develop the highest quality products possible for you.</p>"
    },
    {
      "type": "richtext",
      "id": "text_footer",
      "label": "Footer Text (e.g., small link/note)",
      "default": "<p>Made in Canada, eh!</p>" 
    },
    {
      "type": "header",
      "content": "Text Colors"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "body_text_color",
      "label": "Body Text Color",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "footer_text_color",
      "label": "Footer Text Color",
      "default": "#ffffff"
    }
  ],
  "presets": [
    {
      "name": "Split Section Image Text",
      "category": "Image"
    }
  ]
}
{% endschema %}

{% comment %} Assign variables for easier Liquid logic {% endcomment %}
{% assign img_left = false %}
{% if section.settings.layout_direction == 'left' %}
  {% assign img_left = true %}
{% endif %}

<style>
  /* Reset and base styles */
  .split-outer-wrap-{{ section.id }} {
    width: 100%;
    background-color: {{ section.settings.background_color }};
    padding: 0;
    margin: 0;
  }

  .split-main-container-{{ section.id }} {
    display: flex; /* Default to flex for mobile stacking */
    flex-direction: column;
    width: 100%;
    max-width: 100%;
    margin: 0 auto;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  }

  .split-text-col-{{ section.id }},
  .split-img-col-{{ section.id }} {
    width: 100%;
  }

  /* Text column styles */
  .split-text-col-{{ section.id }} {
    padding: 30px 20px;
    order: 2;
  }
  
  /* Image column styles */
  .split-img-col-{{ section.id }} {
    padding: 0;
    order: 1;
  }
  
  /* Image container - full width and height */
  .split-img-container-{{ section.id }} {
    width: 100%;
    height: 300px;
    overflow: hidden;
    background-position: {{ section.settings.image_position_horizontal }} {{ section.settings.image_position_vertical }};
    background-size: {{ section.settings.image_fit }};
    background-repeat: no-repeat;
    display: flex; /* Use flex to center the inner image container */
    align-items: center;
    justify-content: center;
  }

  .split-img-inner-{{ section.id }} {
    width: 100%;
    height: 100%;
    background-position: {{ section.settings.image_position_horizontal }} {{ section.settings.image_position_vertical }};
    background-size: {{ section.settings.image_fit }};
    background-repeat: no-repeat;
  }
  
  /* Content wrapper */
  .split-text-wrapper-{{ section.id }} {
    max-width: 100%;
    margin: 0 auto;
    text-align: left;
    display: flex;
    flex-direction: column;
    justify-content: center;
  }

  /* Typography - Mobile first (320px+) */
  .split-text-wrapper-{{ section.id }} h2 {
    font-size: 24px;
    line-height: 1.2;
    font-weight: 700;
    margin-bottom: 16px;
    color: {{ section.settings.heading_color }};
  }
  
  .split-text-wrapper-{{ section.id }} .split-body-text-{{ section.id }} p {
    font-size: 14px;
    line-height: 1.6;
    color: {{ section.settings.body_text_color }};
    margin-bottom: 0;
  }
  
  .split-text-wrapper-{{ section.id }} .split-footer-text-{{ section.id }} {
    margin-top: 16px;
    font-size: 13px;
    font-weight: 600;
    color: {{ section.settings.footer_text_color }};
  }

  .split-text-wrapper-{{ section.id }} .split-footer-text-{{ section.id }} p {
    margin: 0;
  }

  /* Small mobile (375px+) and Tablet styles remain the same for mobile/stacked layout */

  /* Small Desktop (768px+) - Switch to horizontal GRID layout */
  @media screen and (min-width: 768px) {
    .split-main-container-{{ section.id }} {
      /* CONVERT TO GRID */
      display: grid;
      /* Define 2 columns: Text (40%) and Image (60%) */
      grid-template-columns: 40% 60%;
      min-height: 55vh;
      max-width: 100%;
      /* IMPORTANT: Remove flex-direction: row; as it's now a grid */
      padding:80px 0px;
    }

    /* GRID column reset for children */
    .split-text-col-{{ section.id }},
    .split-img-col-{{ section.id }} {
      /* Remove max-width/flex rules as grid handles sizing */
      width: auto;
    }

    .split-text-col-{{ section.id }} {
      /* Set to 1st column by default */
      grid-column: 1 / 2;
      padding: 60px 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      /* order property is still valid in grid for re-ordering */
      order: 1; 
    }

    .split-img-col-{{ section.id }} {
      /* Set to 2nd column by default */
      grid-column: 2 / 3;
      padding: 0;
      height: 100%; /* Take full height of the row */
      min-height: 55vh;
      order: 2;
    }

    .split-text-wrapper-{{ section.id }} {
      max-width: 500px;
      padding: 0;
    }

    .split-text-wrapper-{{ section.id }} h2 {
      font-size: 32px;
      margin-bottom: 20px;
    }

    .split-text-wrapper-{{ section.id }} .split-body-text-{{ section.id }} p {
      font-size: 16px;
    }

    .split-img-container-{{ section.id }} {
      height: 100%;
      min-height: 55vh;
    }

    .split-img-inner-{{ section.id }} {
      width: {{ section.settings.image_width }}%;
      height: 100%;
      background-size: {{ section.settings.image_fit }};
      background-attachment: fixed;
    }

    /* Logic for Image on Left layout (Grid re-ordering) */
    {% if img_left %}
      .split-main-container-{{ section.id }} {
        /* Swap column definition */
        grid-template-columns: 60% 40%;
      }
      .split-img-col-{{ section.id }} {
        /* Set image to the first column */
        grid-column: 1 / 2; 
        order: 1;
      }
      .split-text-col-{{ section.id }} { 
        /* Set text to the second column */
        grid-column: 2 / 3; 
        order: 2;
      }
    {% else %}
      /* Default (Image on Right) - Text 40%, Image 60% */
      .split-text-col-{{ section.id }} { grid-column: 1 / 2; order: 1; }
      .split-img-col-{{ section.id }} { grid-column: 2 / 3; order: 2; }
    {% endif %}
  }

  /* Medium Desktop (1024px+) - GRID column updates */
  @media screen and (min-width: 1024px) {
    .split-main-container-{{ section.id }} {
      /* Update columns to 45% Text / 55% Image for larger screens */
      grid-template-columns: 45% 55%;
    }
    {% if img_left %}
      .split-main-container-{{ section.id }} {
        /* Swap column definition for image left */
        grid-template-columns: 55% 45%;
      }
    {% endif %}

    .split-text-col-{{ section.id }} {
      /* Remove flex properties */
      padding: 80px 0px;
    }

    .split-text-wrapper-{{ section.id }} {
      max-width: 500px;
    }

    .split-text-wrapper-{{ section.id }} h2 {
      font-size: 36px;
      margin-bottom: 25px;
    }

    .split-text-wrapper-{{ section.id }} .split-body-text-{{ section.id }} p {
      font-size: 17px;
    }
  }

  /* Large Desktop (1280px+) */
  @media screen and (min-width: 1280px) {
    .split-text-col-{{ section.id }} {
      padding: 100px 80px;
    }

    .split-text-wrapper-{{ section.id }} h2 {
      font-size: 38px;
    }
  }

  /* Extra Large Desktop (1440px+) - GRID column updates */
  @media screen and (min-width: 1440px) {
    .split-main-container-{{ section.id }} {
      /* Update columns to 40% Text / 60% Image for extra large screens */
      grid-template-columns: 40% 60%;
    }
    {% if img_left %}
      .split-main-container-{{ section.id }} {
        /* Swap column definition for image left */
        grid-template-columns: 60% 40%;
      }
    {% endif %}

    .split-text-col-{{ section.id }} {
      /* Remove flex properties */
      padding: 120px 100px;
    }

    .split-text-wrapper-{{ section.id }} {
      max-width: 600px;
    }

    .split-text-wrapper-{{ section.id }} h2 {
      font-size: 40px;
      margin-bottom: 28px;
    }

    .split-text-wrapper-{{ section.id }} .split-body-text-{{ section.id }} p {
      font-size: 18px;
    }
  }

  /* Ultra Wide (1920px+) */
  @media screen and (min-width: 1920px) {
    .split-text-col-{{ section.id }} {
      padding: 140px 120px;
    }

    .split-text-wrapper-{{ section.id }} {
      max-width: 700px;
    }

    .split-text-wrapper-{{ section.id }} h2 {
      font-size: 42px;
      margin-bottom: 30px;
    }

    .split-text-wrapper-{{ section.id }} .split-body-text-{{ section.id }} p {
      font-size: 19px;
      line-height: 1.7;
    }

    .split-text-wrapper-{{ section.id }} .split-footer-text-{{ section.id }} {
      font-size: 16px;
    }
  }
</style>

<div class="split-outer-wrap-{{ section.id }}">
  <div class="split-main-container-{{ section.id }}">
    
    <div class="split-img-col-{{ section.id }}">
      {% assign image_url = section.settings.image | image_url: width: 2000 %}
      <div class="split-img-container-{{ section.id }}">
        <div 
          class="split-img-inner-{{ section.id }}"
          style="background-image: url('{{ image_url }}');"
        >
          {% if section.settings.image == blank %}
            <div class="split-placeholder-{{ section.id }}">
              {% comment %} Fallback for when no image is selected {% endcomment %}
              {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
            </div>
          {% endif %}
        </div>
      </div>
    </div>

    <div class="split-text-col-{{ section.id }}">
      <div class="split-text-wrapper-{{ section.id }}">
        
        {% if section.settings.heading != blank %}
          <h2>{{ section.settings.heading | escape }}</h2>
        {% endif %}
        
        {% if section.settings.subheading != blank %}
          <div class="split-body-text-{{ section.id }}">{{ section.settings.subheading }}</div>
        {% endif %}
        
        {% if section.settings.text_footer != blank %}
          <div class="split-footer-text-{{ section.id }}">{{ section.settings.text_footer }}</div>
        {% endif %}

      </div>
    </div>

  </div>
</div>